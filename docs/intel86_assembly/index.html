<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Intel x86 Assembly Overview - Philmish's Blog</title><meta name=Description content="A overview over the basics of Intel x86 Assembly and its most relevant instructions"><meta property="og:title" content="Intel x86 Assembly Overview">
<meta property="og:description" content="A overview over the basics of Intel x86 Assembly and its most relevant instructions"><meta property="og:type" content="article"><meta property="og:url" content="https://philmish.github.io/docs/intel86_assembly/"><meta property="og:image" content="https://philmish.github.io/logo.png"><meta property="article:section" content="docs"><meta property="article:published_time" content="2023-11-13T00:00:00+00:00"><meta property="article:modified_time" content="2023-11-13T00:00:00+00:00"><meta property="og:site_name" content="Phlmish's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://philmish.github.io/logo.png"><meta name=twitter:title content="Intel x86 Assembly Overview"><meta name=twitter:description content="A overview over the basics of Intel x86 Assembly and its most relevant instructions"><meta name=application-name content="Philmish's Blog"><meta name=apple-mobile-web-app-title content="Philmish's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://philmish.github.io/docs/intel86_assembly/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Intel x86 Assembly Overview","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/philmish.github.io\/docs\/intel86_assembly\/"},"genre":"docs","keywords":"Intel, Assembly, 32-bit, x86","wordcount":1268,"url":"https:\/\/philmish.github.io\/docs\/intel86_assembly\/","datePublished":"2023-11-13T00:00:00+00:00","dateModified":"2023-11-13T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"philmish"},"description":"A overview over the basics of Intel x86 Assembly and its most relevant instructions"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Philmish's Blog"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/ title=Posts><i class="fa-solid fa-file"></i> </a><a class=menu-item href=/tags/ title=Tags><i class="fa-solid fa-tag"></i> </a><a class=menu-item href=/categories/ title=Categories><i class="fa-solid fa-sitemap"></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Philmish's Blog"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title=Posts><i class="fa-solid fa-file"></i></a><a class=menu-item href=/tags/ title=Tags><i class="fa-solid fa-tag"></i></a><a class=menu-item href=/categories/ title=Categories><i class="fa-solid fa-sitemap"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Intel x86 Assembly Overview</h1><div class=content id=content><p>This is an overview over the relevant basics of Intel&rsquo;s x86 Assembly language.</p><h2 id=architecture>Architecture</h2><ul><li>follows <code>Van Neuman</code> architecture</li><li>Hardware components: <code>CPU</code>, <code>RAM</code>, <code>I/O</code></li><li>bitness: <code>little endian</code></li></ul><p><figure><a class=lightgallery href=/images/intel_x86_architecture.png title=architecture data-thumbnail=/images/intel_x86_architecture.png data-sub-html="<h2>Figure 1. Simplified Hardware Layout</h2><p>architecture</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/intel_x86_architecture.png data-srcset="/images/intel_x86_architecture.png, /images/intel_x86_architecture.png 1.5x, /images/intel_x86_architecture.png 2x" data-sizes=auto alt=/images/intel_x86_architecture.png width=748 height=588></a><figcaption class=image-caption>Figure 1. Simplified Hardware Layout</figcaption></figure></p><h2 id=main-memory-layout>Main Memory Layout</h2><ul><li>Data: also called <code>data section</code>, put in place when the program is initially loaded, the values contained in data may not be changed (<code>static</code>) and are available to every part of the program (<code>global</code>)</li><li>Code: includes the instructions fetched by the <code>CPU</code> to execute the program, controls how the program&rsquo;s tasks are orchestrated</li><li>Heap: is used for dynamic memory during execution, changes frequently while the program is running</li><li>Stack: is used for local variables and function parameters, helps control flow</li></ul><p><figure><a class=lightgallery href=/images/intel_x86_mem_layout.png title=memory data-thumbnail=/images/intel_x86_mem_layout.png data-sub-html="<h2>Figure 2. Simplified memory layout</h2><p>memory</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/intel_x86_mem_layout.png data-srcset="/images/intel_x86_mem_layout.png, /images/intel_x86_mem_layout.png 1.5x, /images/intel_x86_mem_layout.png 2x" data-sizes=auto alt=/images/intel_x86_mem_layout.png width=817 height=807></a><figcaption class=image-caption>Figure 2. Simplified memory layout</figcaption></figure></p><h2 id=syntax>Syntax</h2><ul><li>Most instructions are invoked in this format: <code>Mnemonic Destination Source</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nf>mov</span> <span class=no>ecx</span> <span class=mi>0x42</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>each instruction corresponds to <code>opcodes</code></li></ul><h2 id=operands>Operands</h2><ul><li><code>operands</code> are used to identify data used by instructions</li><li>there are 3 types of <code>operands</code>:<ol><li>Immediate operands: fixed values such as 0x42 in the Syntax example</li><li>Register operands: refer to registers, for example <code>ecx</code></li><li>Memory address operands: refer to a memory address which contains value of interest, typically denoted with a value, register or equation in bracktes, like <code>[eax]</code></li></ol></li></ul><h2 id=registers>Registers</h2><ul><li>small amounts of data storage available to the CPU</li><li>can be accessed more quickly than storage available elsewhere</li><li>registers on x86 fall into four categories:<ol><li>General registers: used by the CPU during execution</li><li>Segment registers: used to track sections of memory</li><li>Status Flags: used to make decisions</li><li>Instruction Pointers: are used to keep track of the next instruction to execute</li></ol></li></ul><h3 id=general-registers>General Registers</h3><ul><li><p>EAX (AX AH AL)</p></li><li><p>EBX (BX BH BL)</p></li><li><p>ECX (CX CH CL)</p></li><li><p>EDX (DX DH DL)</p></li><li><p>EBP (BP)</p></li><li><p>ESP (SP)</p></li><li><p>ESI (SI)</p></li><li><p>general registers can either be accessed by their full name to retrieve the full 32-bit of data, but they can also be accessed in 16-bit mode, for example use EDX for all 32-bits in the register and DX to reference the lower 16-bits of the register</p></li><li><p>four of the general registers (<code>EAX</code>, <code>EBX</code>, <code>ECX</code> and <code>EDX</code>) can also be referenced as 8-bit values, for example <code>AL</code> is used to reference the lowest 8-bits of <code>EAX</code> and <code>AH</code> is used to reference the second set of 8-bits, contained in the 16-bit register <code>AX</code></p></li><li><p>some instructions in x86 use specific registers, for example multiplication and division always use <code>EAX</code> and <code>EDX</code></p></li><li><p>if general registers are used in a consistent fashion across a program this is known as a <code>convention</code>, knowing different conventions used by different compilers can be helpful during analysis, for example <code>EAX</code> is commonly used to store the return value of a function, so if you see an operation on the <code>EAX</code> register after a call you can assume the return value is manipulated/used further in the code</p></li></ul><h3 id=segment-registers>Segment Registers</h3><ul><li>CS</li><li>SS</li><li>DS</li><li>ES</li><li>FS</li><li>GS</li></ul><h3 id=status-registers>Status Registers</h3><ul><li><p>EFLAGS</p></li><li><p>the <code>EFLAGS</code> register is a 32-bit status register</p></li><li><p>every bit in it is a flag, it can be set (1) or cleared (0)</p></li></ul><p><figure><a class=lightgallery href=/images/intel_x86_eflags.png title=flags data-thumbnail=/images/intel_x86_eflags.png data-sub-html="<h2>Figure 3. Layout of the EFLAGS register</h2><p>flags</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/intel_x86_eflags.png data-srcset="/images/intel_x86_eflags.png, /images/intel_x86_eflags.png 1.5x, /images/intel_x86_eflags.png 2x" data-sizes=auto alt=/images/intel_x86_eflags.png width=607 height=475></a><figcaption class=image-caption>Figure 3. Layout of the EFLAGS register</figcaption></figure></p><ul><li>some important flags:<ul><li><code>ZF</code>: the Zero Flag is set if the result of an operation is equal to zero, otherwise it is cleared</li><li><code>CF</code>: the Carry Flag is set if the result of an operation is too large or too small for the destination operand, otherwise it is cleared</li><li><code>SF</code>: the Sign Flag is set when the result of an operation is negative or cleared when the result is positive; is also set when the most significant bit is set after an arithmetic operation</li><li><code>TF</code>: the Trap Flag is used for debugging, if the flag is set the x86 processor will only execute one instruction at a time</li></ul></li></ul><h3 id=instruction-pointer>Instruction Pointer</h3><ul><li><p>EIP</p></li><li><p>also known as <code>instruction pointer</code> or <code>program counter</code></p></li><li><p>in x86 it is used to store the memory address of the next instruction to be executed</p></li><li><p>tells the processor what to do next</p></li></ul><h2 id=instructions>Instructions</h2><p>A list of some of the most important instructions, what they do and their syntax.</p><h3 id=mov>mov</h3><ul><li>used to move data from one location to another</li></ul><table><thead><tr><th>Instruction</th><th>Description</th></tr></thead><tbody><tr><td><code>mov eax, ebx</code></td><td>Copies the content of <code>EBX</code> into the <code>EAX</code> register</td></tr><tr><td><code>mov eax, 0x42</code></td><td>Copies the the value <code>0x42</code> into the <code>EAX</code> register</td></tr><tr><td><code>mov eax, [0x4037C4]</code></td><td>Copies the 4 bytes at the memory location <code>0x4037C4</code> into the <code>EAX</code> register</td></tr><tr><td><code>mov eax, [ebx]</code></td><td>Copies the 4 bytes at the memory location specified by the <code>EBX</code> register into the <code>EAX</code> register</td></tr><tr><td><code>mov eax, [ebx+esi*4]</code></td><td>Copies the 4 bytes at the memory location specified by the result of the equation <code>ebx+esi*4</code> into the <code>EAX</code> register</td></tr></tbody></table><h3 id=lea>lea</h3><ul><li><code>load effective address</code></li><li>format: <code>lea destination, source</code></li><li>used to put a memory address into the destination</li><li>in contrast to <code>mov</code> which moves the content at memory location into the destination</li><li>example: <code>lea eax, [ebx+8]</code> will put <code>ebx+8</code> into <code>EAX</code>, while <code>mov eax, [ebx+8]</code> loads the data at the memory address specified by <code>ebx+8</code> into <code>EAX</code></li></ul><p><figure><a class=lightgallery href=/images/intel_x86_mov_vs_lea.png title=lea data-thumbnail=/images/intel_x86_mov_vs_lea.png data-sub-html="<h2>Figure 4. Difference between mov and lea</h2><p>lea</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/intel_x86_mov_vs_lea.png data-srcset="/images/intel_x86_mov_vs_lea.png, /images/intel_x86_mov_vs_lea.png 1.5x, /images/intel_x86_mov_vs_lea.png 2x" data-sizes=auto alt=/images/intel_x86_mov_vs_lea.png width=891 height=466></a><figcaption class=image-caption>Figure 4. Difference between mov and lea</figcaption></figure></p><h3 id=arithmetic>Arithmetic</h3><h4 id=addition-and-subtraction>Addition and Subtraction</h4><table><thead><tr><th>Instruction</th><th>Description</th></tr></thead><tbody><tr><td><code>sub eax, 0x10</code></td><td>Subtracts <code>0x10</code> from <code>EAX</code></td></tr><tr><td><code>add eax, ebx</code></td><td>Adds <code>EBX</code> to <code>EAX</code> and stores the result in <code>EAX</code></td></tr><tr><td><code>inc edx</code></td><td>Increments <code>EDX</code> by 1</td></tr><tr><td><code>dec edx</code></td><td>Decrements <code>ECX</code> by 1</td></tr></tbody></table><h4 id=multiplication-and-division>Multiplication and Division</h4><ul><li>both always act on predefined registers</li><li>this requires correct setup of the related registers before the us of the <code>mul</code> or <code>div</code> instructions</li><li>the syntax for the instruction is <code>mul/div value</code>, as the registers used are already predefined</li><li><code>mul</code> and <code>div</code> operate on unsigned value, <code>imul</code> and <code>idiv</code> are their equivalents for operations on signed values</li></ul><table><thead><tr><th>Instruction</th><th>Description</th></tr></thead><tbody><tr><td><code>mul 0x50</code></td><td>Multiplies <code>EAX</code> by <code>0x50</code> and stores the result in <code>EDX:EAX</code></td></tr><tr><td><code>div 0x75</code></td><td>Divides <code>EDX:EAX</code> by <code>0x75</code> and stores the result in <code>EAX</code> and the remainder in <code>EDX</code></td></tr></tbody></table><h5 id=multiplication>Multiplication</h5><ul><li><code>mul</code> always multiplies <code>EAX</code> with the provided <code>value</code>, so <code>EAX</code> needs to be setup correctly before the instruction</li><li>the result is store as a 64-bit value across <code>EDX</code> and <code>EAX</code></li><li><code>EDX</code> stores the 32 most significant bits and <code>EAX</code> the least significant bits of the return value</li></ul><h5 id=division>Division</h5><ul><li><code>div</code> divides the 64-bits stored across <code>EDX</code> and <code>EAX</code> by <code>value</code></li><li>both <code>EDX</code> and <code>EAX</code> must be setup correctly for the use of the instruction</li><li>the result of the division is stored in <code>EAX</code> and the remainder in <code>EDX</code></li><li>the remainder can be accessed with the <code>modulo</code> operator, which will access <code>EDX</code> after running <code>div</code></li></ul><h4 id=logical-operators>Logical Operators</h4><ul><li><code>AND</code>, <code>OR</code>, <code>XOR</code>, <code>SHL</code>, <code>SHR</code>, <code>ROR</code>, <code>ROL</code> for example</li><li>work like <code>add</code> and <code>sub</code>, perform operation between specified <code>source</code> and <code>destination</code> and storing the result in <code>destination</code></li><li><code>xor</code> can be used as an optimization by the compiler to set a register to 0 by <code>xor</code> it with itself, like <code>xor eax, eax</code> to set <code>EAX</code> to 0, as the instruction only requires 2 bytes instead of 5 for an equivalent <code>mov</code> instruction</li><li><code>shl</code> and <code>shr</code> are used to shift registers, their format is <code>shr/shl destination, count</code></li><li>they shift the bits in <code>destination</code> left (<code>shl</code>) or right (<code>shr</code>) by the number of bits specified by <code>count</code></li><li>bits shifted beyond the boundary are first shifted into <code>CF</code> (Carry Flag Bit), zero bits in the <code>destination</code> are filled in, so after the instruction <code>CF</code> contains the last bit shifted beyond the boundary</li><li>in comparison <code>ror</code> and <code>rol</code> shift the <code>destination</code> and append the bits going over the boundary are rotated to the other site</li></ul><table><thead><tr><th>Instruction</th><th>Description</th></tr></thead><tbody><tr><td><code>xor eax, eax</code></td><td>Clears the <code>EAX</code> register</td></tr><tr><td><code>or eax, 0x7575</code></td><td>Perform the logical or operation on <code>EAX</code> with <code>0x7575</code></td></tr><tr><td><code>shl eax, 2</code></td><td>Shifts <code>EAX</code> register to the left 2 bits</td></tr><tr><td><code>ror bl, 2</code></td><td>Rotates the BL register to the right 2 bits, fall-off bits will be rotated in to the right</td></tr></tbody></table></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://philmish.github.io/ target=_blank>philmish</a></span>&nbsp;|&nbsp;<span class=license><a rel="This is free and unencumbered software released into the public domain." href=https://unlicense.org target=_blank>The Unlicense</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"Philmish's Blog","id-2":"Philmish's Blog"},lightgallery:!0,search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>